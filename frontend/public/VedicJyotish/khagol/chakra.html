<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="manifest" href="/khagol/manifest.webmanifest" />
        <meta name="theme-color" content="#333333" />
        <link rel="apple-touch-icon" href="/khagol/icon-192x192.08c9e472.png" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>काल चक्र</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&display=swap"
            rel="stylesheet" />
        <link rel="stylesheet" href="/khagol/chakra.71a534a0.css" />
        <script src="/khagol/chakra.8551f171.js" charset="utf-8"></script>
        <script src="/khagol/chakra.c63e2104.js" charset="utf-8"></script>
        <script src="/khagol/chakra.14543136.js" charset="utf-8"></script>
        <script src="/khagol/chakra.4d7f28ae.js" charset="utf-8"></script>
        <script src="/khagol/chakra.6b2d9cf3.js" charset="utf-8"></script>
        <script src="/khagol/chakra.0a0d7463.js" charset="utf-8"></script>
        <script src="/khagol/chakra.8fb34eea.js" charset="utf-8"></script>
        <script src="/khagol/chakra.66dddef1.js"></script>
        <script src="/khagol/chakra.5a2089eb.js"></script>
        <script type="module">
            var e = globalThis,
                r = {},
                o = {},
                i = e.parcelRequiree5f4;
            (null == i &&
                (((i = function (e) {
                    if (e in r) return r[e].exports;
                    if (e in o) {
                        var i = o[e];
                        delete o[e];
                        var t = { id: e, exports: {} };
                        return (
                            (r[e] = t),
                            i.call(t.exports, t, t.exports),
                            t.exports
                        );
                    }
                    var n = Error("Cannot find module '" + e + "'");
                    throw ((n.code = "MODULE_NOT_FOUND"), n);
                }).register = function (e, r) {
                    o[e] = r;
                }),
                (e.parcelRequiree5f4 = i)),
                (0, i.register)("jAOHZ", function (e, r) {
                    var o;
                    ((o = "sw.js"),
                        (o = i.i?.[o] || o),
                        (e.exports = import.meta.resolve("./" + o)));
                }),
                "serviceWorker" in navigator &&
                    window.addEventListener("load", () => {
                        navigator.serviceWorker
                            .register(i("jAOHZ"))
                            .then(e => {
                                console.log("Service Worker registered:", e);
                            })
                            .catch(e => {
                                console.error(
                                    "Service Worker registration failed:",
                                    e
                                );
                            });
                    }));
        </script>
        <style>
            #controls-top-left {
                min-width: 150px;
                top: 2%;
                left: 5%;
            }
            #controls-top-right {
                top: 2%;
                right: 5%;
            }
            #controls-bottom-right {
                min-width: 100px;
                bottom: 10%;
                right: 5%;
            }
            .corner-controls {
                color: #323232cc;
                z-index: 20;
                cursor: pointer;
                background-color: #eee;
                border-radius: 8px;
                padding: 10px;
                font-size: 14px;
                position: absolute;
                box-shadow: 0 2px 5px #0006;
            }
            .pagination a {
                color: #000;
                float: left;
                border-radius: 6px;
                padding: 12px;
                text-decoration: none;
            }
            .pagination a.active {
                color: #003;
                font-weight: 700;
            }
            .pagination a:hover:not(.active) {
                background-color: #ddd;
            }
        </style>
    </head>
    <body>
        <div id="controls-top-right" class="corner-controls">
            <span
                id="info-top-right-button"
                style="text-align: right; font-size: 2em; display: inline-block"
                data-expanded="false"
                >⚙</span
            >
            <div id="info-top-right-content" style="display: none">
                <span id="info-top-right"></span> <br /><input
                    type="checkbox"
                    id="ephemeris-type" />
                सूर्य सिद्धांत (mean) <br /><input type="checkbox" id="sayan" />
                सायन
            </div>
        </div>
        <div id="controls-top-left" class="corner-controls">
            <span id="info-top-left"></span>
        </div>
        <div id="zodiac-container">
            <svg
                id="zodiacWheel"
                preserveAspectRatio="xMidYMid meet"
                style="display: block"
                viewBox="0 0 600 600">
                <title>काल चक्र</title>
                <desc>
                    A dynamic chakra showing Rashi, Nakshatra, and planet
                    positions.
                </desc>
            </svg>
            <svg
                id="solar-system-svg"
                preserveAspectRatio="xMidYMid meet"
                style="display: none"
                viewBox="0 0 600 600" />
            <svg
                id="kundali-svg"
                preserveAspectRatio="xMidYMid meet"
                style="display: none"
                viewBox="0 0 600 600" />
            <div
                id="info-view"
                style="min-width: 80%; display: none; overflow-y: auto"></div>
        </div>
        <div class="pagination">
            <a
                id="show-chakra"
                class="active"
                href="#"
                onclick="switchView('zodiacWheel')"
                >राशि चक्र
            </a>
            <a
                id="show-solar-system"
                href="#"
                onclick="switchView('solar-system-svg')"
                >ग्रहपथ</a
            >
            <a id="show-kundali" href="#" onclick="switchView('kundali-svg')"
                >कुंडली</a
            >
            <a id="show-info" href="#" onclick="switchView('info-view')"
                >विवरण</a
            >
        </div>
        <div id="controls" style="text-align: center">
            <span id="current-date-display">Current Date</span>
            <div class="control-group">
                <div
                    id="time-scrubber"
                    title="Drag left/right to change time. Speed increases with distance from center.">
                    <div id="scrubber-indicator"></div>
                </div>
            </div>
            <input type="number" id="day-input" min="1" max="31" step="1" />
            <input type="number" id="month-input" min="1" max="12" step="1" />
            <input type="number" id="year-input" step="1" placeholder="YYYY" />
            <input
                type="number"
                id="hour-input"
                min="0"
                max="23"
                step="1" />:<input
                type="number"
                id="minute-input"
                min="0"
                max="59"
                step="1" />
            <button type="button" class="button1" id="goto-now" title="Now">
                अभी
            </button>
            <button
                type="button"
                class="button1"
                id="goto-kaliyug-start"
                title="Go to 3102 BCE (Start of Kali Yuga)">
                युगारंभ
            </button>
        </div>
        <script>
            let infoView,
                timeControl,
                infoTopLeft = document.getElementById("info-top-left"),
                infoTopRight = document.getElementById("info-top-right"),
                ephemerisType = document.getElementById("ephemeris-type"),
                sayanToggle = document.getElementById("sayan"),
                solarSystemView = new SolarSystemSVG("solar-system-svg"),
                kundaliView = new KundaliSVG("kundali-svg");
            function switchView(e) {
                (console.log("Switching view to:", e),
                    (document.getElementById("zodiacWheel").style.display =
                        "none"),
                    (solarSystemView.svg.style.display = "none"),
                    (kundaliView.svg.style.display = "none"),
                    infoView &&
                        infoView.container &&
                        (infoView.container.style.display = "none"),
                    document
                        .querySelectorAll(".pagination a")
                        .forEach(e => e.classList.remove("active")));
                let t = null;
                switch (e) {
                    case "zodiacWheel":
                        t = "show-chakra";
                        break;
                    case "solar-system-svg":
                        t = "show-solar-system";
                        break;
                    case "kundali-svg":
                        t = "show-kundali";
                        break;
                    case "info-view":
                        t = "show-info";
                }
                t && document.getElementById(t).classList.add("active");
                let a = document.getElementById(e);
                (a
                    ? (a.style.display = "block")
                    : (console.error("View element not found:", e),
                      (document.getElementById("zodiacWheel").style.display =
                          "block")),
                    timeControl && updateView(timeControl.dt));
            }
            function updateView(e) {
                if (!e) return;
                let t = daysSinceKaliYugaStart(e);
                var a = sayanToggle.checked;
                let n = getAyanamsa(e, a);
                ((infoTopLeft.innerHTML = infoTopLeft.hasAttribute(
                    "data-expanded"
                )
                    ? getPanchang(e, grahaManager.getPlanets())
                    : "<b>पञ्चाङ्ग</b>"),
                    (infoTopRight.innerHTML = `<b>\u{905}\u{939}\u{930}\u{94D}\u{917}\u{923}</b> ${t}<br><b>\u{905}\u{92F}\u{928}\u{93E}\u{902}\u{936}</b> ${n}`));
                let i = { lat: 23.1765, lon: 75.7885 };
                if (
                    (ephemerisType.checked
                        ? grahaManager.calculateSuryaSidhdhantaPosition(e, a)
                        : grahaManager.calculatePlanetPosition(e, a, i),
                    "block" ==
                        document.getElementById("zodiacWheel").style.display &&
                        rashiChakra.drawWheel(grahaManager.getPlanets()),
                    "block" == solarSystemView.svg.style.display &&
                        solarSystemView.drawSystem(
                            grahaManager.getPlanets(),
                            n
                        ),
                    "block" == kundaliView.svg.style.display)
                ) {
                    let e =
                        n +
                        calculateAscendant(
                            grahaManager.getLST(),
                            (23.5 * Math.PI) / 180,
                            i
                        );
                    kundaliView.drawKundali(grahaManager.getPlanets(), e);
                }
                infoView &&
                    infoView.container &&
                    "block" == infoView.container.style.display &&
                    infoView.displayInfo(grahaManager.getPlanets());
            }
            document.addEventListener("DOMContentLoaded", () => {
                ((window.grahaManager = new GrahaManager()),
                    (window.rashiChakra = new RashiChakra("zodiacWheel")),
                    (infoView = new InfoView("info-view")),
                    (timeControl = new TimeControl(new Date(), updateView)),
                    ephemerisType.addEventListener("change", () =>
                        updateView(timeControl.dt)
                    ),
                    sayanToggle.addEventListener("change", () =>
                        updateView(timeControl.dt)
                    ),
                    document
                        .getElementById("controls-top-left")
                        .addEventListener("click", () => {
                            (infoTopLeft.hasAttribute("data-expanded")
                                ? infoTopLeft.removeAttribute("data-expanded")
                                : infoTopLeft.setAttribute(
                                      "data-expanded",
                                      "true"
                                  ),
                                updateView(timeControl.dt));
                        }),
                    document
                        .getElementById("controls-top-right")
                        .addEventListener("click", () => {
                            (infoTopRight.hasAttribute("data-expanded")
                                ? (infoTopRight.removeAttribute(
                                      "data-expanded"
                                  ),
                                  (document.getElementById(
                                      "info-top-right-content"
                                  ).style.display = "none"))
                                : (infoTopRight.setAttribute(
                                      "data-expanded",
                                      "true"
                                  ),
                                  (document.getElementById(
                                      "info-top-right-content"
                                  ).style.display = "block")),
                                updateView(timeControl.dt));
                        }));
            });
        </script>
    </body>
</html>
